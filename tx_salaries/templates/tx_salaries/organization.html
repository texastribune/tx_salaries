{% extends "tx_salaries/layouts/base.html" %}

{% block title %}{{ org.name }}{{ block.super }}{% endblock %}

{% load humanize %}
{% load static from staticfiles %}

{% block breadcrumb_items %}
<li>{{ org.agency }}</li>
{% endblock %}

{% block main_content %}

<link rel="stylesheet" href="{% static "tx_salaries/css/app.css" %}">

<div class="grid overview">

  <div id="main-content" class="cell w-9">
    <div class="grid">
      <h3>{{ org.name }}</h3>
      <ul>
        <li>{{ org.agency }}</li>
        <li>Data received on {{ org.updated }}</li>
      </ul>
    </div>

    <hr>

    <div class="grid">
      <div class="cell w-3 agency-stats">
        <ul>
          <li>
            <h3>{{ org.emp_count|intcomma }}</h3>
            <p>employees</p>
          </li>
          <li>
            <h3>{{ org.stats.female.total_number|intcomma }}</h3>
            <p>female employees</p>
          </li>
          <li>
            <h3>{{ org.stats.male.total_number|intcomma }}</h3>
            <p>male employees</p>
          </li>
        </ul>
      </div>

      <div class="cell w-3">
        <img class="pie-chart" src="https://chart.googleapis.com/chart?cht=p&chd=t:{{ org.stats.female.total_number }},{{ org.stats.male.total_number}}&chs=150x100&chdl=Female|Male">
      </div>

      <div class="cell w-6">
        <!-- <div class="middle-text">
          {% for slice in org.stats.female.distribution.slices %}
            <p>${{ slice.start|intcomma }} &#8212; ${{ slice.end|intcomma }}</p>
          {% endfor %}
        </div> -->
        <div class="bars-container" style="float:left;">
          {% for slice in org.stats.female.distribution.slices %}
          <p>
            <div class="bar-w" style="width:{% widthratio slice.count 200 160 %}px"></div>
            {{ slice.count }}
          </p>
          {% endfor %}
        </div>
        <div class="bars-container" style="float:right;">
          {% for slice in org.stats.male.distribution.slices %}
          <p>
            <div class="bar-m" style="width:{% widthratio slice.count 200 160 %}px"></div>
            {{ slice.count }}
          </p>
          {% endfor %}
        </div>
      </div>

      <div class="grid">
        <div class="cell w-8">
          <h3>Top salaries in {{ org.name }}</h3>
          <table class="tt-table striped">
            <thead>
              <th>Name</th>
              <th>Title</th>
              <th>Department</th>
              <th>Salary</th>
            </thead>
            <tbody>
              {% for employee in top_salaries %}
                <tr>
                  <td><a href="employee/{{ employee.id }}">{{ employee.position.person.name }}</a></td>
                  <td>{{ employee.title.name }}</td>
                  <td>{{ employee.position.organization.name }}</td>
                  <td>${{ employee.compensation|intcomma }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="cell w-4">
          <h3>Top job titles in {{ org.name }}</h3>
          <table class="tt-table striped">
            <thead>
              <th>Title</th>
              <th>Median Salary</th>
            </thead>
            <tbody>
              {% for job in top_jobs %}
                <tr>
                  <td>{{ job.position.label }} </td>
                  <td>${{ job.median_paid.compensation|intcomma }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div><!-- end main -->

  <div class="cell w-3 explorer_rail">
    <p>Todo: search</p>
  </div>
{% endblock %}
